# Exploits
## [BCTextEncoder_Hooker.cpp](./BCTextEncoder_Hooker.cpp) - DLL for Injecting into BCTextEncoder to Capture User Input

`BCTextEncoder_Hooker.cpp` is a DLL designed to be injected into the **BCTextEncoder** process, leveraging the MinHook library to hook the `WideCharToMultiByte` function. The primary goal is to capture and log wide-character strings, such as passwords, used for decoding messages. The DLL writes these captured inputs to a log file, enabling further analysis.

#### Features:
- **DLL injection**: This DLL is intended for injection into BCTextEncoder, hooking the `WideCharToMultiByte` function.
- **Password logging**: Captures and logs user input, particularly passwords entered during message decoding.
- **MinHook integration**: Uses MinHook to intercept the `WideCharToMultiByte` function without modifying the original process behavior.
- **Log output**: Captures and saves data to `C:\Windows\Tasks\hooker.log`.

#### Usage:
- **Injection**: The DLL can be injected into the BCTextEncoder process through various methods, such as using a process injection tool or a custom injector. (I forgot which one i uses lol)
- **Log capture**: Once injected, the hooked function logs any input passed to `WideCharToMultiByte` to a file for analysis.

## [nginx-403.py](./nginx-403.py) - Bypass Nginx 403 Restrictions

`nginx-403.py` is a tool specifically crafted to find 403 bypasses in scenarios where Nginx is being used as a reverse proxy, and the backend server (such as Python-based frameworks) may be vulnerable to [parsing attacks](https://book.hacktricks.xyz/pentesting-web/proxy-waf-protections-bypass). The script sends raw HTTP requests with special or non-printable characters appended to the URL, potentially bypassing Nginx's restrictions while exposing backend behavior.

#### Features:
- **403 bypass detection**: Attempts to bypass Nginx 403 Forbidden restrictions by appending non-printable characters to the URL path.
- **Raw HTTP requests**: Sends raw, low-level HTTP requests directly to the server to avoid interference from higher-level libraries.
- **Custom headers**: Allows the inclusion of custom headers in requests.
- **Save successful responses**: Option to save responses to files if the status code is not 403, allowing further analysis.

#### Usage:
```bash
nginx-403.py <url> [--header "Header: Value"] [--success]
```

## [nodered_decrypt.py](./nodered_decrypt.py) - Decrypt Node-RED Credential Flows

`nodered_decrypt.py` is a Python script for decrypting the credentials stored in the `flows_cred.json` file used by Node-RED. It uses the `_credentialSecret` from the `.config.runtime.json` file to derive the encryption key and decrypt the credential data, allowing to access sensitive information securely stored by Node-RED. [source](https://www.hardill.me.uk/wordpress/2021/02/17/viewing-node-red-credentials/)

#### Features:
- Decrypts credentials from Node-RED's `flows_cred.json` file.
- Uses the `_credentialSecret` from `.config.runtime.json` to derive the AES encryption key.
- Outputs decrypted credentials in JSON format for easy access.

#### Usage:
```bash
nodered_decrypt.py <flows_cred.json> <.config.runtime.json>
```

## [ofbiz2hashcat.py](./ofbiz2hashcat.py) - Convert Apache OFBiz Hashes for Hashcat (Mode 120)

`ofbiz2hashcat.py` is a Python script that converts Apache OFBiz hashes into a format suitable for cracking with Hashcat using mode 120. It processes the input hash by extracting the salt and base64-encoded hash, then converts it into a format Hashcat can work with.

#### Usage:
```bash
ofbiz2hashcat.py <hash_string> [-o <output_file>]
```
## [openWB_RCE_2bdd255.py](./openWB_RCE_2bdd255.py) - Remote Code Execution in openWB v1.9

`openWB_RCE_2bdd255.py`  is a Remote Code Execution (RCE) vulnerability in [openWB](https://github.com/snaptec/openWB), specifically targeting the `/web/settings/saveconfig.php` endpoint. This vulnerability arises from inadequate validation of user inputs in the context of command execution.

### Vulnerability Details

The `/web/settings/saveconfig.php` endpoint processes POST requests and incorporates user-supplied data directly into command-line executions without sufficient validation. The affected parameters are:
- `$_POST['etprovider']`
- `$_POST['socmodul']`
- `$_POST['socmodul1']`

Although `escapeshellcmd()` was used to sanitize the inputs, it fails to prevent **path traversal attacks**, such as `../../../../`. As a result, attackers can bypass the protection and construct malicious inputs that enable command execution outside of the intended directories.

This vulnerability was disclosed and **fixed in commit** [2bdd255](https://github.com/snaptec/openWB/commit/2bdd255f1a907f675be5ce6b6b19d938d082962c) of the openWB project.

### Features:
- **Command Execution**: The exploit sends crafted payloads to trigger path traversal and arbitrary command execution on the openWB server.
- **Reverse Shell Capability**: The exploit sets up a reverse shell by downloading and executing a stager script from an HTTP server.
- **Reverse Shell Handler**: Includes a customizable reverse shell listener and HTTP server that serves the stager payload.

### Usage:
```bash
python3 openWB_RCE_2bdd255.py <target_url> <listen_host> --exec_script <path_to_stager_script> [options]
```

### Options:
- `--lport`: Specify the port for the reverse shell listener (default: 9001).
- `--srvport`: Port for the HTTP server that serves the stager script (default: 8000).
- `--exec_script`: Path to the stager script that will be executed on the openWB server.
- `--proxy`: Optional proxy for sending requests through Burp Suite for further debugging.

## [pwsmdecrypt.py](./pwsmdecrypt.py) - Decrypt PSWM Password Vault Files

This tool is designed to decrypt [pwsm](https://github.com/Julynx/pswm) password vault files in `.pswm` format using a brute force attack with a wordlist. It attempts to decrypt the encrypted vault by trying each password from the specified wordlist (defaulting to `rockyou.txt`). Once successfully decrypted, it presents the contents in a well-formatted table showing the alias, username, and password.


#### Usage:
```bash
pwm_decryptor.py <vault_file> -w <wordlist_path>
```

If no wordlist is specified, the tool defaults to `rockyou.txt`.


## [rdp_plus_decrypt.py](./rdp_plus_decrypt.py) - Decrypt Remote Desktop Plus Profile Passwords

`rdp_plus_decrypt.py` is a Python script used to decrypt passwords stored in Remote Desktop Plus profiles. It supports two modes of operation: decrypting a single base64-encoded password via the `--password` option or batch-decrypting passwords from an XML profiles export using the `--profiles` option.

#### Features:
- **Single password decryption**: Decrypt a single base64-encoded password with the `--password` flag.
- **Batch profile decryption**: Decrypt multiple passwords from a Remote Desktop Plus XML profiles export with the `--profiles` flag.
- **DES encryption**: Uses DES encryption with the hardcoded key and IV to decrypt the passwords.

#### Usage:
```bash
rdp_plus_decrypt.py --password <base64_encoded_password>
rdp_plus_decrypt.py --profiles <path_to_profiles.xml>
```

## [SolarPuttyDecrypt.py](./SolarPuttyDecrypt.py) - Decrypt Solar PuTTy Session Files

`SolarPuttyDecrypt.py` is a Python script designed to decrypt session files from [Solar PuTTy](https://www.solarwinds.com/free-tools/solar-putty), a tool for managing remote sessions. It supports two modes: decrypting a session file with a known password or brute-forcing the password using a wordlist.

#### Usage:
```bash
â”Œâ”€â”€(kaliðŸ˜ˆkali)-[~]
â””â”€$ python3 SolarPuttyDecrypt.py sessions.dat --brute
[+] Starting brute force using wordlist: /usr/share/wordlists/rockyou.txt

[âœ…] Password found: darthmaulismysecretlove

==================================================
[ðŸ”’] Sessions:
==================================================
    ðŸ”¹ Session Name: DeathStar
    ðŸ”¹ IP: 192.168.0.66
    ðŸ”¹ Port: 22

==================================================
[ðŸ”‘] Credentials:
==================================================
    ðŸ”¹ Credentials Name: imperial-admin
    ðŸ”¹ Username: vader
    ðŸ”¹ Password: miga2020!
```



